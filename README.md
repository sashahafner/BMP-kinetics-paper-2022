# BMP-kinetics-paper-2022
Public repository with data and analysis for the (forthcoming) 2022 paper evaluating kinetic data from biochemical methane potential (BMP) tests. 

# References
Reference 1 is an open-access paper that describes the data presented here in this repository.
Reference 2, also open-access, describes the original inter-laboratory study that generated the measurements used.

1. Hafner, S.D., Astals, S., Holliger, C., Koch, K., Nielsen, L., Refsahl, L., Weinrich, S. 2022. Assessing the value of kinetic results from biochemical methane potential tests: Reproducibility from a large inter-laboratory study. Cleaner Chemical Engineering. URL: <https://doi.org/10.1016/j.clce.2022.100065>, doi: 10.1016/j.clce.2022.100065
2. Hafner, S.D., Fruteau de Laclos, H., Koch, K., Holliger, C., 2020. Improving inter-laboratory reproducibility in measurement of biochemical methane potential (BMP). Water 12, 1752. URL: <https://www.mdpi.com/2073-4441/12/6/1752>, doi:10.3390/w12061752. 

# Description of files
## `data`
Directory contains data files as comma-separated text files.
See `scripts/load.R` for an example of reading into R.

* `bottles.csv` bottle size and contents by bottle (and test) key
* `kinetics.csv` kinetic model results by bottle and approach
* `kin_summ_sub.csv` summary of kinetic model results by substrate and approach
* `kin_summ_sub_test.csv` summary of kinetic model results by substrate, study, formal test, and approach
* `SMP.csv` specific methane production (SMP) by bottle and measurement interval
* `tests.csv` measurement method information by test key

## `plot_scripts`
Contains R scripts for generating the plots in `plots`.
Run `main.R` in R in a local copy of this repository to recreate plots.

## `plots`
Contains two pdf files with SMP and methane production rate for each individual bottle in a separate plot.
These were generated by R from the scripts in `plot_scripts`.

# Variables
* `approach.fit` integer key for model approach defined by combination of  `lag.rem`, `fit.to`, and `fit.last`
* `B0.md` median ultimate BMP
* `B0.sd` ultimate BMP standard deviation (% of B0)
* `B0` ultimate BMP
* `bottle.id` unique key for each bottle
* `cvBg` cumulative total (gross) biogas volume (from start to end of `time.d`) produced (mL dry at 0 deg. C and 1 atm)
* `cvCH4` cumulative total (gross) methane volume (from start to end of `time.d`) produced (mL dry at 0 deg. C and 1 atm)
* `fit.last` model forced through last point? Boolean (`TRUE` or `FALSE`) 
* `fit.to` fit to `SMP` and `rate.SMP`
* `fv.inoc` fraction of total methane production attributed to inoculum
* `int.id` unique key for each measurement interval
* `ISR` inoculum-to-substrate ratio
* `k.md` median first-order rate constant k (1/d)
* `k.sd` standard deviation in k (% of k)
* `k` k (1/d)
* `lab.id` unique key for each laboratory
* `lag.n0` number of bottles with lag phase duration of 0
* `lag.rem` was lag phase removed for model application? Boolean (`TRUE` or `FALSE`) 
* `m.inoc.vs` mass of inoculum added to bottle as VS (g)
* `m.inoc` mass of inoculum added to bottle as fresh mass (g)
* `m.sub.vs` mass of substrate added to bottle as VS (g)
* `m.sub` mass of substrate added to bottle as fresh mass (g)
* `ME.md` median model efficiency
* `ME` model efficiency
* `method.biogas` method used to measure biogas production
* `method.comp` method used to measure biogas composition
* `mix` bottle mixing information
* `n.bot.c` number of bottles where fitting algorithm converged
* `n.bot.nc` number of bottles where fitting algorithm did not converge
* `n.cond` number of conditions (each with typically 3 bottles)
* `rate.SMP.pred` SMP rate calcualated by model with approach 1 (mL dry methane at 0C and 1 atm per g substrate VS per d)
* `rate.SMP` SMP rate (mL dry methane at 0C and 1 atm per g substrate VS per d)
* `rylag.md` median relative SMP during lag phase
* `SMP.pred` specific methane production (SMP) calculated by model (approach 1) (mL dry methane at 0C and 1 atm per g substrate VS)
* `SMP` SMP
* `study` "study" as defined in reference 2
* `substrate` substrate key as described in reference 2
* `test.id` unique key for each BMP test (1 lab, set up at one time, etc.)
* `test` "test" as defined in reference 2
* `time.d` time of measurement from start of BMP test (d)
* `tlag.md` median duration of lag phase (d)
* `tlag` duration of lag phase (d)
* `vBg` total (gross) biogas volume produced in interval (mL dry at 0 deg. C and 1 atm)
* `vCH4` total (gross) methane volume produced in interval (mL dry at 0 deg. C and 1 atm)
* `vol.bot` BMP bottle volume (mL)
* `vol.hs` BMP bottle headspace volume (mL)
* `xCH4` mole or volume fraction of methane in biogas
* `ylag.md` median SMP production during lag phase (units same as SMP)
* `ylag` SMP production during lag phase (units same as SMP)

# Other resources
For guidance on measuring BMP, see the collection of resources at the [Standard BMP Methods website](https://www.dbfz.de/en/bmp/).

